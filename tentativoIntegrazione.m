base_str = ['x.^3' "y.^3" "(x.^2).*y" "x.*(y.^2)" "x.^2" "y.^2" "x.*y" "x" "y" "1"];
base = @(x,y) [x^3 y^3 (x^2)*y x*(y^2) x^2 y^2 x*y x y 1]';
ymax = @(x) 1 - x;
integrals = zeros(10,1);
integrals(10) = 0.5;
for i=1:9
    n = zeros(10,1);
    n(i) = 1;
    stringa = char(base_str(i));
    fun = str2func(['@(x, y) ' stringa]);
    q = integral2(fun,0,1,0,ymax);
    integrals(i) = q;
end

sqrt15 = sqrt(15.0);
matrix = zeros(10,10);
xhat = [ 1/3,...
	 (6 + sqrt15) / 21,...
	 (9 - 2*sqrt15) / 21,...
	 (6 + sqrt15) / 21,...
	 (6 - sqrt15) / 21,...
	 (9 + 2*sqrt15) / 21,...
	 (6 - sqrt15) / 21,...
     0.2,...
     0.6,...
     0.4];

yhat = [1/3,...
	(6 + sqrt15) / 21,...
	(6 + sqrt15) / 21,...
	(9 - 2*sqrt15) / 21,...
	(6 - sqrt15) / 21,...
	(6 - sqrt15) / 21,...
	(9 + 2*sqrt15) / 21, ...
    0.6,...
    0.2,...
    0.4];

for i = 1:10
    matrix(i,:) = base(xhat(i), yhat(i))';
end
 
omega = minres(matrix,integrals, 1.0e-4, 200000);
